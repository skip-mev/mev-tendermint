(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{628:function(e,t,n){"use strict";n.r(t);var a=n(0),o=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"indexing-transactions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#indexing-transactions"}},[e._v("#")]),e._v(" Indexing Transactions")]),e._v(" "),n("p",[e._v("Tendermint allows you to index transactions and later query or subscribe\nto their results.")]),e._v(" "),n("p",[e._v("Events can be used to index transactions and blocks according to what happened\nduring their execution. Note that the set of events returned for a block from\n"),n("code",[e._v("BeginBlock")]),e._v(" and "),n("code",[e._v("EndBlock")]),e._v(" are merged. In case both methods return the same\ntype, only the key-value pairs defined in "),n("code",[e._v("EndBlock")]),e._v(" are used.")]),e._v(" "),n("p",[e._v("Each event contains a type and a list of attributes, which are key-value pairs\ndenoting something about what happened during the method's execution. For more\ndetails on "),n("code",[e._v("Events")]),e._v(", see the [ABCI]https://github.com/tendermint/tendermint/blob/main/spec/abci/abci.md#events) documentation.")]),e._v(" "),n("p",[e._v("An Event has a composite key associated with it. A "),n("code",[e._v("compositeKey")]),e._v(" is constructed by its type and key separated by a dot.\nFor example:")]),e._v(" "),n("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"JnF1b3Q7amFjayZxdW90OzogWwogICZxdW90O2FjY291bnQubnVtYmVyJnF1b3Q7OiAxMDAKXQo="}}),e._v(" "),n("p",[e._v("would be equal to the composite key of "),n("code",[e._v("jack.account.number")]),e._v(".")]),e._v(" "),n("p",[e._v("Let's take a look at the "),n("code",[e._v("[tx_index]")]),e._v(" config section:")]),e._v(" "),n("tm-code-block",{staticClass:"codeblock",attrs:{language:"toml",base64:"IyMjIyMgdHJhbnNhY3Rpb25zIGluZGV4ZXIgY29uZmlndXJhdGlvbiBvcHRpb25zICMjIyMjClt0eF9pbmRleF0KCiMgV2hhdCBpbmRleGVyIHRvIHVzZSBmb3IgdHJhbnNhY3Rpb25zCiMKIyBPcHRpb25zOgojICAgMSkgJnF1b3Q7bnVsbCZxdW90OwojICAgMikgJnF1b3Q7a3YmcXVvdDsgKGRlZmF1bHQpIC0gdGhlIHNpbXBsZXN0IHBvc3NpYmxlIGluZGV4ZXIsIGJhY2tlZCBieSBrZXktdmFsdWUgc3RvcmFnZSAoZGVmYXVsdHMgdG8gbGV2ZWxEQjsgc2VlIERCQmFja2VuZCkuCmluZGV4ZXIgPSAmcXVvdDtrdiZxdW90OwoKIyBDb21tYS1zZXBhcmF0ZWQgbGlzdCBvZiBjb21wb3NpdGUga2V5cyB0byBpbmRleCAoYnkgZGVmYXVsdCB0aGUgb25seSBrZXkgaXMgJnF1b3Q7dHguaGFzaCZxdW90OykKIwojIFlvdSBjYW4gYWxzbyBpbmRleCB0cmFuc2FjdGlvbnMgYnkgaGVpZ2h0IGJ5IGFkZGluZyAmcXVvdDt0eC5oZWlnaHQmcXVvdDsga2V5IGhlcmUuCiMKIyBJdCdzIHJlY29tbWVuZGVkIHRvIGluZGV4IG9ubHkgYSBzdWJzZXQgb2Yga2V5cyBkdWUgdG8gcG9zc2libGUgbWVtb3J5CiMgYmxvYXQuIFRoaXMgaXMsIG9mIGNvdXJzZSwgZGVwZW5kcyBvbiB0aGUgaW5kZXhlcidzIERCIGFuZCB0aGUgdm9sdW1lIG9mCiMgdHJhbnNhY3Rpb25zLgppbmRleF9rZXlzID0gJnF1b3Q7JnF1b3Q7CgojIFdoZW4gc2V0IHRvIHRydWUsIHRlbGxzIGluZGV4ZXIgdG8gaW5kZXggYWxsIGNvbXBvc2l0ZUtleXMgKHByZWRlZmluZWQga2V5czoKIyAmcXVvdDt0eC5oYXNoJnF1b3Q7LCAmcXVvdDt0eC5oZWlnaHQmcXVvdDsgYW5kIGFsbCBrZXlzIGZyb20gRGVsaXZlclR4IHJlc3BvbnNlcykuCiMKIyBOb3RlIHRoaXMgbWF5IGJlIG5vdCBkZXNpcmFibGUgKHNlZSB0aGUgY29tbWVudCBhYm92ZSkuIEluZGV4a2V5cyBoYXMgYQojIHByZWNlZGVuY2Ugb3ZlciBJbmRleEFsbEtleXMgKGkuZS4gd2hlbiBnaXZlbiBib3RoLCBJbmRleEtleXMgd2lsbCBiZQojIGluZGV4ZWQpLgppbmRleF9hbGxfa2V5cyA9IGZhbHNlCg=="}}),e._v(" "),n("p",[e._v("By default, Tendermint will index all transactions by their respective\nhashes using an embedded simple indexer. Note, we are planning to add\nmore options in the future (e.g., PostgreSQL indexer).")]),e._v(" "),n("h2",{attrs:{id:"adding-events"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#adding-events"}},[e._v("#")]),e._v(" Adding Events")]),e._v(" "),n("p",[e._v("In your application's "),n("code",[e._v("DeliverTx")]),e._v(" method, add the "),n("code",[e._v("Events")]),e._v(' field with pairs of\nUTF-8 encoded strings (e.g. "transfer.sender": "Bob", "transfer.recipient": "Alice",\n"transfer.balance": "100").')]),e._v(" "),n("p",[e._v("Example:")]),e._v(" "),n("tm-code-block",{staticClass:"codeblock",attrs:{language:"go",base64:"ZnVuYyAoYXBwICpLVlN0b3JlQXBwbGljYXRpb24pIERlbGl2ZXJUeChyZXEgdHlwZXMuUmVxdWVzdERlbGl2ZXJUeCkgdHlwZXMuUmVzdWx0IHsKICAgIC8vLi4uCiAgICBldmVudHMgOj0gW11hYmNpLkV2ZW50ewogICAgICAgIHsKICAgICAgICAgICAgVHlwZTogJnF1b3Q7dHJhbnNmZXImcXVvdDssCiAgICAgICAgICAgIEF0dHJpYnV0ZXM6IGt2LlBhaXJzewogICAgICAgICAgICAgICAga3YuUGFpcntLZXk6IFtdYnl0ZSgmcXVvdDtzZW5kZXImcXVvdDspLCBWYWx1ZTogW11ieXRlKCZxdW90O0JvYiZxdW90Oyl9LAogICAgICAgICAgICAgICAga3YuUGFpcntLZXk6IFtdYnl0ZSgmcXVvdDtyZWNpcGllbnQmcXVvdDspLCBWYWx1ZTogW11ieXRlKCZxdW90O0FsaWNlJnF1b3Q7KX0sCiAgICAgICAgICAgICAgICBrdi5QYWlye0tleTogW11ieXRlKCZxdW90O2JhbGFuY2UmcXVvdDspLCBWYWx1ZTogW11ieXRlKCZxdW90OzEwMCZxdW90Oyl9LAogICAgICAgICAgICB9LAogICAgICAgIH0sCiAgICB9CiAgICByZXR1cm4gdHlwZXMuUmVzcG9uc2VEZWxpdmVyVHh7Q29kZTogY29kZS5Db2RlVHlwZU9LLCBFdmVudHM6IGV2ZW50c30KfQo="}}),e._v(" "),n("p",[e._v('If you want Tendermint to only index transactions by "transfer.sender" event type,\nin the config set '),n("code",[e._v('tx_index.index_tags="transfer.sender"')]),e._v(". If you to index all events,\nset "),n("code",[e._v("index_all_tags=true")])]),e._v(" "),n("p",[e._v("Note, there are a few predefined event types:")]),e._v(" "),n("ul",[n("li",[n("code",[e._v("tx.hash")]),e._v(" (transaction's hash)")]),e._v(" "),n("li",[n("code",[e._v("tx.height")]),e._v(" (height of the block transaction was committed in)")])]),e._v(" "),n("p",[e._v("Tendermint will throw a warning if you try to use any of the above keys.")]),e._v(" "),n("h2",{attrs:{id:"querying-transactions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#querying-transactions"}},[e._v("#")]),e._v(" Querying Transactions")]),e._v(" "),n("p",[e._v("You can query the transaction results by calling "),n("code",[e._v("/tx_search")]),e._v(" RPC endpoint:")]),e._v(" "),n("tm-code-block",{staticClass:"codeblock",attrs:{language:"shell",base64:"Y3VybCAmcXVvdDtsb2NhbGhvc3Q6MjY2NTcvdHhfc2VhcmNoP3F1ZXJ5PVwmcXVvdDthY2NvdW50Lm5hbWU9J2lnb3InXCZxdW90OyZhbXA7cHJvdmU9dHJ1ZSZxdW90Owo="}}),e._v(" "),n("p",[e._v("Check out "),n("a",{attrs:{href:"https://docs.tendermint.com/v0.33/rpc/#/Info/tx_search",target:"_blank",rel:"noopener noreferrer"}},[e._v("API docs"),n("OutboundLink")],1),e._v(" for more information\non query syntax and other options.")]),e._v(" "),n("h2",{attrs:{id:"subscribing-to-transactions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#subscribing-to-transactions"}},[e._v("#")]),e._v(" Subscribing to Transactions")]),e._v(" "),n("p",[e._v("Clients can subscribe to transactions with the given tags via WebSocket by providing\na query to "),n("code",[e._v("/subscribe")]),e._v(" RPC endpoint.")]),e._v(" "),n("tm-code-block",{staticClass:"codeblock",attrs:{language:"json",base64:"ewogICZxdW90O2pzb25ycGMmcXVvdDs6ICZxdW90OzIuMCZxdW90OywKICAmcXVvdDttZXRob2QmcXVvdDs6ICZxdW90O3N1YnNjcmliZSZxdW90OywKICAmcXVvdDtpZCZxdW90OzogJnF1b3Q7MCZxdW90OywKICAmcXVvdDtwYXJhbXMmcXVvdDs6IHsKICAgICZxdW90O3F1ZXJ5JnF1b3Q7OiAmcXVvdDthY2NvdW50Lm5hbWU9J2lnb3InJnF1b3Q7CiAgfQp9Cg=="}}),e._v(" "),n("p",[e._v("Check out "),n("a",{attrs:{href:"https://docs.tendermint.com/v0.33/rpc/#subscribe",target:"_blank",rel:"noopener noreferrer"}},[e._v("API docs"),n("OutboundLink")],1),e._v(" for more information\non query syntax and other options.")])],1)}),[],!1,null,null,null);t.default=o.exports}}]);